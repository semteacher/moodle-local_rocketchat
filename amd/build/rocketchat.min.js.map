{"version":3,"file":"rocketchat.min.js","sources":["../src/rocketchat.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to initialise the Rocket.Chat courses- and role integration settings.\n *\n * @module      local_rocketchat/rocketchat\n * @copyright   2016 GetSmarter {@link http://www.getsmarter.co.za}\n * @author      2021 Adrian Perez <me@adrianperez.me> {@link https://adrianperez.me}\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport Ajax from 'core/ajax';\n\nconst setRocketChatCourseSync = (courseid, pendingsync) => {\n    Ajax.call([\n        {\n            methodname: 'local_rocketchat_set_rocketchat_course_sync',\n            args: {\n                courseid: courseid,\n                pendingsync: pendingsync\n            }\n        }\n    ]);\n};\n\nconst setRocketChatEventBasedSync = (courseid, eventbasedsync) => {\n    Ajax.call([\n        {\n            methodname: 'local_rocketchat_set_rocketchat_event_based_sync',\n            args: {\n                courseid: courseid,\n                eventbasedsync: eventbasedsync\n            }\n        }\n    ]);\n};\n\nconst setRocketChatManuallyTriggerSync = (courseid) => {\n    Ajax.call([\n        {\n            methodname: 'local_rocketchat_manually_trigger_sync',\n            args: {\n                courseid: courseid\n            }\n        }\n    ]);\n\n    location.reload();\n};\n\nconst setRocketChatRoleSync = (roleid, requiresync) => {\n    Ajax.call([\n        {\n            methodname: 'local_rocketchat_set_rocketchat_role_sync',\n            args: {\n                roleid: roleid,\n                requiresync: requiresync\n            }\n        }\n    ]);\n};\n\nexport const init = () => {\n    const courses = $('#integrated-courses');\n    const roles = $('#integrated-roles');\n\n    courses.on('click', 'input[name=\"pendingsync\"]', function() {\n        setRocketChatCourseSync($(this).data('courseid'), $(this).is(\":checked\"));\n    });\n\n    courses.on('click', 'input[name=\"eventbasedsync\"]', function() {\n        setRocketChatEventBasedSync($(this).data('courseid'), $(this).is(\":checked\"));\n    });\n\n    courses.on('click', 'button', function(e) {\n        e.preventDefault();\n\n        $(this).text(\"Syncing ...\");\n        $(this).prop(\"disabled\", \"disabled\");\n\n        setRocketChatManuallyTriggerSync($(this).data('courseid'), this);\n    });\n\n    roles.on('click', 'input', function() {\n        setRocketChatRoleSync($(this).data('roleid'), $(this).is(\":checked\"));\n    });\n};"],"names":["courses","roles","on","courseid","pendingsync","this","data","is","call","methodname","args","eventbasedsync","e","preventDefault","text","prop","location","reload","roleid","requiresync"],"mappings":";;;;;;;;4KA4EoB,eACVA,SAAU,mBAAE,uBACZC,OAAQ,mBAAE,qBAEhBD,QAAQE,GAAG,QAAS,6BAA6B,WArDrB,IAACC,SAAUC,YAAVD,UAsDD,mBAAEE,MAAMC,KAAK,YAtDFF,aAsDe,mBAAEC,MAAME,GAAG,0BArD5DC,KAAK,CACN,CACIC,WAAY,8CACZC,KAAM,CACFP,SAAUA,SACVC,YAAaA,mBAmDzBJ,QAAQE,GAAG,QAAS,gCAAgC,WA7CpB,IAACC,SAAUQ,eAAVR,UA8CD,mBAAEE,MAAMC,KAAK,YA9CFK,gBA8Ce,mBAAEN,MAAME,GAAG,0BA7ChEC,KAAK,CACN,CACIC,WAAY,mDACZC,KAAM,CACFP,SAAUA,SACVQ,eAAgBA,sBA2C5BX,QAAQE,GAAG,QAAS,UAAU,SAASU,GArCF,IAACT,SAsClCS,EAAEC,qCAEAR,MAAMS,KAAK,mCACXT,MAAMU,KAAK,WAAY,YAzCSZ,UA2CD,mBAAEE,MAAMC,KAAK,0BA1C7CE,KAAK,CACN,CACIC,WAAY,yCACZC,KAAM,CACFP,SAAUA,aAKtBa,SAASC,YAoCThB,MAAMC,GAAG,QAAS,SAAS,WAjCD,IAACgB,OAAQC,YAARD,QAkCD,mBAAEb,MAAMC,KAAK,UAlCJa,aAkCe,mBAAEd,MAAME,GAAG,0BAjCxDC,KAAK,CACN,CACIC,WAAY,4CACZC,KAAM,CACFQ,OAAQA,OACRC,YAAaA"}